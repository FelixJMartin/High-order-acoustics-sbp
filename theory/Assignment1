### Assignment 1 â€“ Task 1: Well-posed Boundary Conditions

Well-posedness is analyzed using the **energy method**.  
Taking the inner product of the governing equation with \(u\) and integrating by parts yields the energy rate

\[
\frac{d}{dt}\|u\|^2
=
u^\ast \mathbf{C}^{-1}\mathbf{A}u \Big|_{x_r}^{x_l}
-
\|u\|_{2\mathbf{C}^{-1}\mathbf{D}}^2,
\]

where the volume terms vanish due to symmetry and  
\(\mathbf{C}^{-1}\mathbf{D} = (\mathbf{C}^{-1}\mathbf{D})^\ast \ge 0\).

---

### Boundary Contribution

The boundary term is
\[
u^\ast \mathbf{C}^{-1}\mathbf{A}u
=
\rho c^2 p v + \frac{1}{\rho} p v.
\]

Imposing the general boundary conditions
\[
p + a_l v = 0 \quad \text{at } x=x_l, \qquad
p + a_r v = 0 \quad \text{at } x=x_r,
\]
the energy rate becomes
\[
-(\rho c^2 a_l + \tfrac{a_l}{\rho}) v^2 \Big|_{x_l}
+
(\rho c^2 a_r + \tfrac{a_r}{\rho}) v^2 \Big|_{x_r}.
\]

To ensure non-increasing energy, the parameters must satisfy
\[
\boxed{a_l > 0, \qquad a_r < 0.}
\]

---

### Characteristic Boundary Conditions

The eigenvalues of \(-\mathbf{C}^{-1}\mathbf{A}\) are
\[
\lambda = \pm c,
\]
corresponding to left- and right-traveling waves.

Choosing
\[
\boxed{
\begin{aligned}
p + c v &= 0, \quad x = x_l, \\
p - c v &= 0, \quad x = x_r,
\end{aligned}
}
\]
imposes **characteristic (absorbing) boundary conditions**, eliminating incoming characteristics and yielding a well-posed problem.


## Task 2 

\subsection{Second task: SBP--Projection discretization and stability}

In this task, stable SBP--Projection approximations of the 1D acoustic wave equation are constructed using both
\emph{central difference SBP operators} $D_1$ and \emph{upwind SBP operators} $D_\pm$.
Stability is proven using the discrete energy method for Dirichlet and characteristic boundary conditions.

The semi-discrete SBP--Projection formulation is
\[
\mathbf{v}_t = -P C^{-1} (D_x + D) P \mathbf{v},
\]
where the projection operator is defined by
\[
P = I - \bar{H}^{-1} L^T (L \bar{H}^{-1} L^T)^{-1} L,
\]
enforcing the boundary conditions weakly.

The discrete operators are given by
\[
D_x =
\begin{bmatrix}
0 & D_{1/\,+} \\
D_{1/\,-} & 0
\end{bmatrix},
\quad
C^{-1} =
\begin{bmatrix}
\overline{\rho c^2} & 0 \\
0 & \overline{\rho^{-1}}
\end{bmatrix},
\quad
D =
\begin{bmatrix}
\bar{\beta} & 0 \\
0 & 0
\end{bmatrix},
\]
and the discrete solution vector is
\[
\mathbf{v} =
\begin{bmatrix}
\bar{p} \\
\bar{v}
\end{bmatrix}.
\]

Different choices of the constraint matrix $L$ correspond to the imposed boundary conditions:
pressure Dirichlet, velocity Dirichlet, and characteristic boundary conditions.

---

### Discrete Energy Stability

To analyze stability, the discrete energy norm
\[
\|\mathbf{v}\|_{\tilde{H}}^2 = \mathbf{v}^T \tilde{H} \mathbf{v},
\qquad
\tilde{H} = \bar{H} C,
\]
is considered. Using symmetry properties of the SBP operators and the projection operator
($\tilde{H}P = P^T\tilde{H}$), the energy rate satisfies
\[
\frac{d}{dt}\|\mathbf{v}\|_{\tilde{H}}^2
=
- w^T
\begin{bmatrix}
0 & B \\
B & 0
\end{bmatrix}
w
-
w^T
\begin{bmatrix}
2H\bar{\beta} & 0 \\
0 & 0
\end{bmatrix}
w,
\]
where $w = P\mathbf{v}$ and $B = -e_l e_l^T + e_r e_r^T$.

The damping term is non-negative since $2H\bar{\beta} \ge 0$.  
For all considered boundary conditions, the projection operator enforces $Lw = 0$, which eliminates the boundary contribution.

Therefore,
\[
\frac{d}{dt}\|\mathbf{v}\|_{\tilde{H}}^2 \le 0,
\]
proving that the SBP--Projection discretization is \emph{energy stable} for both central and upwind SBP operators.


## ðŸ”¹ Assignment 1 â€“ Task 3: Numerical Stability and CFL Analysis

The SBPâ€“Projection discretization leads to a linear ODE system
\[
\mathbf{u}_t = M \mathbf{u},
\]
where \( M \) is the discretization matrix.

Numerical stability is verified by computing the eigenvalues of \( M \).
Stability requires
\[
\operatorname{Re}(\lambda) \le 0,
\]
for all eigenvalues. Negative real parts correspond to numerical damping, while purely
imaginary eigenvalues indicate energy-conserving wave propagation.

---

### Discretization Matrix

Assuming
\[
\rho = 1, \quad c = 1, \quad \beta = 0,
\]
the matrix simplifies to
\[
M = - P D_x P,
\qquad
D_x =
\begin{bmatrix}
0 & D_+ \\
D_- & 0
\end{bmatrix},
\]
where \( D_+ \) and \( D_- \) are the 7th-order upwind SBP operators.
Different choices of the projection operator \( P \) correspond to pressure Dirichlet,
velocity Dirichlet, and characteristic boundary conditions.

---

### Eigenvalue Analysis

The eigenvalues of \( M \), scaled by the grid spacing \( h \), are computed using
MATLABâ€™s `eig` function:
\[
h\,\lambda(M).
\]

For all boundary conditions, the eigenvalues satisfy
\[
\operatorname{Re}(\lambda) \le 0,
\]
confirming numerical stability.

```text
figures/task3_eigvals_Mh.jpg


### CFL Condition (RK4)

For explicit time integration using the classical 4th-order Rungeâ€“Kutta (RK4) method,
stability requires that all eigenvalues of the semi-discrete system satisfy
\[
k\,|\lambda| \le 2.78,
\]
where \( k \) is the time step and \( \lambda \) denotes the eigenvalues of the
discretization matrix \( M \).

Defining the CFL number as
\[
\alpha = \frac{k}{h},
\]
this yields
\[
\alpha = \frac{2.78}{h\,|\lambda_{\max}|},
\]
where \( |\lambda_{\max}| \) is the largest eigenvalue magnitude of \( M \).

The maximum eigenvalues obtained numerically are
\[
\begin{aligned}
|\lambda_{\max}|_{\text{characteristic}} &\approx 43.63, \\
|\lambda_{\max}|_{p=0} &\approx 43.63, \\
|\lambda_{\max}|_{v=0} &\approx 43.63.
\end{aligned}
\]

Since the values are nearly identical, the CFL number is the same for all boundary
conditions:
\[
\boxed{\alpha = 1.5930.}
\]

Thus, a stable time step for RK4 is given by
\[
\Delta t = 1.5930\, h.
\]


